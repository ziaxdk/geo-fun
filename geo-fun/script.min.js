(function(){var a=angular.module("geofun",["ngAnimate"]);a.controller("c",["$scope","$http","$timeout",function(b,h,e){var d=this;d.latLon=null;d.newest=null;d.newestFlag=false;d.msg=[];var g=L.map("map").setView([56,11],8);L.tileLayer("http://{s}.tile.osm.org/{z}/{x}/{y}.png").addTo(g);g.on("click",function(i){b.$apply(function(){d.latLon=i.latlng})});var f=L.featureGroup().addTo(g);var c=1;b.$watch(function(){return d.latLon},function(j,i){if(!j){return}h.get("/api/geo",{params:{lat:j.lat,lon:j.lng}}).then(function(k){var l=k.data;d.msg.splice(0,1,{id:c++,val:l.stats.took});if(!l.res){return}d.newest=l.res.nr+" "+l.res.navn;d.newestFlag=true;e(function(){d.newestFlag=false},2000);L.geoJson(l.res.polygon,{}).bindPopup(d.newest).addTo(f)})})}])}());